---
# install
- name: binfmt > arch
  include_tasks: arch.yaml
  when: ansible_distribution == 'Archlinux'
- name: binfmt > debian or ubuntu
  include_tasks: debian.yaml
  when: ansible_distribution == 'Debian' or ansible_distribution == 'Ubuntu'
- name: binfmt > openSUSE
  include_tasks: suse.yaml
  when: ansible_distribution == 'openSUSE Tumbleweed'

# config
- name: binfmt > config
  become: yes
  become_user: root
  copy:
    src: qemu-static.conf
    dest: /etc/binfmt.d/qemu-static.conf

# service
- name: binfmt > systemd-binfmt.service
  become: yes
  become_user: root
  ansible.builtin.systemd:
    name: systemd-binfmt.service
    enabled: true
    state: started
