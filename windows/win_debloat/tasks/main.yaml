---
# AI
- name: Debloat -> Disable Recall
  win_shell: |
    $cuPath = "HKCU:\Software\Policies\Microsoft\Windows\WindowsAI"
    if (-not (Test-Path $cuPath)) { New-Item -Path $cuPath -Force | Out-Null }
    $lmPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsAI"
    if (-not (Test-Path $lmPath)) { New-Item -Path $lmPath -Force | Out-Null }

    # Disable AI Data Analysis for current user
    Set-ItemProperty -Path "HKCU:\Software\Policies\Microsoft\Windows\WindowsAI" -Name "DisableAIDataAnalysis" -Value 1 -Type DWord

    # Disable AI Data Analysis for all users (machine-wide)
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsAI" -Name "DisableAIDataAnalysis" -Value 1 -Type DWord

    # Disable Recall Enablement (machine-wide)
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsAI" -Name "AllowRecallEnablement" -Value 0 -Type DWord

    # Turn off saving snapshots (machine-wide)
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsAI" -Name "TurnOffSavingSnapshots" -Value 1 -Type DWord
